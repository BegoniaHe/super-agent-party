<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Electron App</title>
  <link rel="stylesheet" href="css/styles.css">
  <!-- 引入Element Plus样式 -->
  <link rel="stylesheet" href="node_modules/element-plus/dist/index.css">
</head>
<body>
  <div id="app">
    <!-- 顶部栏 -->
    <el-header class="top-bar" height="30px">
      <div class="window-controls">
        <el-button @click="minimizeWindow" class="top-bar-btn" text>
          <el-icon><Minus /></el-icon>
        </el-button>
          <el-button @click="maximizeWindow" class="top-bar-btn" text>
          <el-icon><Expand /></el-icon>
        </el-button>
        <el-button @click="closeWindow" class="top-bar-btn" text>
          <el-icon><Close /></el-icon>
        </el-button>
      </div>
    </el-header>

    <!-- 主容器 -->
    <el-container class="main-container">
      <!-- 侧边栏 -->
      <el-aside :width="isCollapse ? '64px' : '200px'" class="sidebar">
        <el-menu
          :collapse="isCollapse"
          :default-active="activeMenu"
          class="el-menu-vertical"
          @select="handleSelect">
          <el-menu-item index="home">
            <el-icon><House /></el-icon>
            <template #title>主页</template>
          </el-menu-item>
          <el-menu-item index="settings">
            <el-icon><Setting /></el-icon>
            <template #title>设置</template>
          </el-menu-item>
        </el-menu>
      </el-aside>

      <!-- 内容区 -->
      <el-main class="content">
        <div v-show="activeMenu === 'home'" class="page chat-container">
          <!-- 聊天消息列表 -->
          <div class="messages-container" ref="messagesContainer">
            <div v-for="(message, index) in messages" :key="index" class="message" :class="message.role">
              <div class="message-content" 
                   v-html="message.role === 'user' ? message.content : formatMessage(message.content)">
              </div>
            </div>
            <div v-if="isTyping" class="message assistant">
              <div class="message-content typing">
                <div class="typing-indicator">
                  <span></span>
                  <span></span>
                  <span></span>
                </div>
              </div>
            </div>
          </div>
          
        <!-- 输入框区域 -->
        <div class="input-container">
          <el-input
            v-model="userInput"
            type="textarea"
            :rows="3"
            placeholder="输入消息..."
            resize="none"
            @keydown="handleKeydown"
          />
          <el-button type="primary" @click="sendMessage" :loading="isTyping">发送</el-button>
        </div>
        </div>
        
        <div v-show="activeMenu === 'settings'" class="page">
          <el-form :model="settings" class="settings-form">
            <el-form-item>
              <el-input 
                v-model="settings.modelName" 
                placeholder="模型名称"
                @input="autoSaveSettings" 
                class="full-width-input"
              />
            </el-form-item>
            <el-form-item>
              <el-input 
                v-model="settings.baseURL" 
                placeholder="基础URL"
                @input="autoSaveSettings"
                class="full-width-input"
              />
            </el-form-item>
            <el-form-item>
              <el-input 
                v-model="settings.apiKey" 
                placeholder="API密钥" 
                show-password
                @input="autoSaveSettings"
                class="full-width-input"
              />
            </el-form-item>
          </el-form>
        </div>
      </el-main>
    </el-container>
  </div>

  <!-- 引入Vue和Element Plus -->
  <script src="node_modules/vue/dist/vue.global.js"></script>
  <script src="node_modules/element-plus/dist/index.full.js"></script>
  <script src="node_modules/@element-plus/icons-vue/dist/index.iife.min.js"></script>
  <script src="js/renderer.js"></script>
</body>
</html>
