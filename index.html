<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Super API Party</title>
  <link rel="stylesheet" href="css/styles.css">
  <!-- GitHub Markdown CSS for styling -->
  <link rel="stylesheet" href="css/github-markdown.min.css">
  <!-- Highlight.js CSS for code highlighting -->
  <link rel="stylesheet" href="css/github.min.css">
  <script src="js/clipboard.min.js"></script>
  <!-- 引入Element Plus样式 -->
  <link rel="stylesheet" href="node_modules/element-plus/dist/index.css">
  <link rel="icon" href="./source/icon.png" type="image/png">
  <!-- Include markdown-it and highlight.js scripts -->
  <script src="js/markdown-it.min.js"></script>
  <script src="js/highlight.min.js"></script>
  <!--  MathJax 配置  -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [
          ['$', '$'],       // 常见的行内公式定界符
          ['\\(', '\\)'],   // 另一种常见的行内公式定界符
          ['(', ')'],
        ],
        displayMath: [
          ['$$', '$$'],     // 常见的行间公式定界符
          ['\\[', '\\]'],   // 另一种常见的行间公式定界符
          ['[', ']'],
        ],
      },
      svg: {
        fontCache: 'global' // 使用全局字体缓存
      },
      startup: {
        pageReady: () => {
          // 可选：页面加载完成后执行一些操作
          console.log("MathJax is ready!");
        }
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body>
  <div id="app">
    <!-- 顶部栏 -->
    <el-header v-if="isElectron" class="top-bar" height="30px">
      <div class="window-controls">
        <el-button @click="minimizeWindow" class="top-bar-btn" text>
          <el-icon><Minus /></el-icon>
        </el-button>
        <el-button @click="maximizeWindow" class="top-bar-btn" text>
          <el-icon><Expand /></el-icon>
        </el-button>
        <el-button @click="closeWindow" class="top-bar-btn" text>
          <el-icon><Close /></el-icon>
        </el-button>
      </div>
    </el-header>    

    <!-- 主容器 -->
    <el-container class="main-container">
      <!-- 侧边栏 -->
      <el-aside :width="isCollapse ? '64px' : '200px'" class="sidebar">
        <el-menu
          :collapse="isCollapse"
          :default-active="activeMenu"
          class="el-menu-vertical"
          @select="handleSelect">
          <el-menu-item index="home">
            <el-icon><chat-dot-square /></el-icon>
            <template #title>对话</template>
          </el-menu-item>
          <el-menu-item index="settings">
            <el-icon><cpu /></el-icon>
            <template #title>主模型</template>
          </el-menu-item>
          <el-menu-item index="tools">
            <el-icon><tools /></el-icon>
            <template #title>工具</template>
          </el-menu-item>
          <el-menu-item index="reasoner">
            <el-icon><magic-stick /></el-icon>
            <template #title>推理模型</template>
          </el-menu-item>
          <el-menu-item index="websearch">
            <el-icon><search /></el-icon>
            <template #title>联网搜索</template>
          </el-menu-item>
          <el-menu-item index="document">
            <el-icon><document /></el-icon>
            <template #title>知识库</template>
          </el-menu-item>
          <el-menu-item index="api-box">
            <el-icon><box /></el-icon>
              <template #title>钥匙箱</template>
            </el-menu-item>
          <el-menu-item index="api">
            <el-icon><connection /></el-icon>
            <template #title>API</template>
          </el-menu-item>
          <el-menu-item index="web">
            <el-icon><compass /></el-icon>
            <template #title>浏览器模式</template>
          </el-menu-item>
        </el-menu>
      </el-aside>

      <!-- 内容区 -->
      <el-main class="content">
        <!-- 聊天界面保持不变 -->
        <div v-show="activeMenu === 'home'" class="page chat-container">
          <!-- 聊天消息列表 -->
          <div class="messages-container" ref="messagesContainer">
            <div v-for="(message, index) in messages" :key="index" class="message" :class="message.role">
              <div class="message-content">
                <!-- 用户消息内容 -->
                <div v-if="message.role === 'user'" class="user-message-content">
                  <div v-html="message.content"></div>
                  <!-- 文件链接展示 -->
                  <div v-if="message.fileLinks?.length" class="file-links">
                    <a
                      v-for="(link, linkIndex) in message.fileLinks"
                      :key="linkIndex"
                      :href="link.path"
                      target="_blank"
                      class="file-link"
                    >
                      @{{ link.name }}
                    </a>
                  </div>
                </div>
                <!-- AI回复内容 -->
                <div v-else class="markdown-body" v-html="formatMessage(message.content)"></div>

              </div>
            </div>
          </div>
            <!-- 文件上传对话框 -->
            <el-dialog 
              v-model="showUploadDialog" 
              title="上传文件" 
              width="30%"
              :before-close="() => showUploadDialog = false">
              
              <div class="upload-container">
                <!-- 可点击的拖拽区域 -->
                <div 
                  class="drop-zone"
                  @dragover.prevent
                  @drop.prevent="handleDrop"
                  @click="browseFiles"
                >
                  <el-icon :size="50"><upload /></el-icon>
                  <p>点击或拖放文件到此区域</p>
                </div>
              </div>
            </el-dialog>
            <div class="button-group">
              <el-button 
                @click="clearMessages" 
                class="icon-btn clear-btn" 
                type="danger" 
                :icon="'Delete'" 
                circle>
              </el-button>
              <el-button 
                @click="sendFiles" 
                class="icon-btn file-btn" 
                :icon="'DocumentAdd'" 
                circle>
              </el-button>
              <el-button 
                @click="sendMessage" 
                type="primary"
                class="icon-btn send-btn" 
                :icon="'Promotion'" 
                circle>
              </el-button>
            </div>                  
              <div class="input-container">
                <!-- 紧凑型文件列表 -->
                <div class="compact-file-list" v-if="files.length">
                  <div v-for="(file, index) in files" :key="index" class="compact-file-item">
                    <span class="file-name">@{{ file.name }}</span>
                    <el-button 
                      @click.stop="removeFile(index)"
                      class="delete-icon" 
                      :icon="'delete'" 
                      circle
                    />
                  </div>
                </div>
                <el-input
                  v-model="userInput"
                  type="textarea"
                  :rows="4"
                  placeholder="输入消息..."
                  resize="none"
                  @keydown="handleKeydown"
                />
              </div>
        </div>
        <div v-show="activeMenu === 'api-box'" class="page tools-container">
          <div class="keybox-container">
            <!-- 磁贴网格 -->
            <div class="provider-grid">
              <!-- 已有供应商磁贴 -->
              <div class="provider-card" v-for="(provider, index) in modelProviders" :key="provider.id">
                <div class="card-header">
                  <el-tag type="info" class="vendor-tag">{{ provider.vendor }}</el-tag>
                  <div class="card-actions">
                    <el-button 
                      @click="fetchModelsForProvider(provider)"
                      :icon="'Search'"
                      circle
                      size="small"
                    ></el-button>
                    <el-button 
                      @click="removeProvider(index)"
                      type="danger" 
                      :icon="'Delete'"
                      circle
                      size="small"
                    ></el-button>
                  </div>
                </div>
                
                <div class="input-group">
                  <!-- 添加输入框标签 -->
                  <div class="input-item">
                    <label>API 地址</label>
                    <el-input
                      v-model="provider.url"
                      placeholder="API地址"
                      @change="autoSaveSettings"
                    />
                  </div>
                  
                  <div class="input-item">
                    <label>API 密钥</label>
                    <el-input
                      v-model="provider.apiKey"
                      placeholder="API密钥"
                      show-password
                      @change="autoSaveSettings"
                    />
                  </div>
                  
                  <div class="input-item">
                    <label>模型 ID</label>
                    <el-input
                      v-model="provider.modelId"
                      placeholder="模型ID"
                      @change="autoSaveSettings"
                    />
                  </div>
                  <div class="model-container">
                    <el-select 
                      v-model="provider.modelId"
                      placeholder="选择模型"
                      v-if="provider.models?.length"
                      class="model-select"
                      placeholder="模型列表"
                      @change="autoSaveSettings"
                    >
                      <el-option
                        v-for="model in provider.models"
                        :key="model"
                        :label="model"
                        :value="model"
                      />
                    </el-select>
                  </div>
                </div>
              </div>
              <!-- 添加新磁贴 -->
              <div class="provider-card add-tile" @click="showAddDialog = true">
                <el-icon :size="40" color="#909399"><Plus /></el-icon>
                <div style="color: #606266; margin-top: 10px;">添加新供应商</div>
              </div>
            </div>
        
            <!-- 添加供应商对话框 -->
            <el-dialog
              v-model="showAddDialog"
              title="添加新供应商"
              width="500px"
              @closed="newProviderTemp = { vendor: '', url: '' }"
            >
              <el-form label-position="top">
                <el-form-item label="供应商类型" required>
                  <el-select 
                    v-model="newProviderTemp.vendor" 
                    placeholder="请选择"
                    @change="handleVendorChange"
                  >
                    <el-option
                      v-for="item in vendorOptions"
                      :key="item.value"
                      :label="item.label"
                      :value="item.value"
                    />
                  </el-select>
                </el-form-item>
        
                <el-form-item 
                  v-if="newProviderTemp.vendor === 'custom'" 
                  label="自定义URL"
                  required
                >
                  <el-input
                    v-model="newProviderTemp.url"
                    placeholder="https://api.example.com/v1"
                  />
                </el-form-item>
        
                <div v-if="newProviderTemp.vendor && newProviderTemp.vendor !== 'custom'">
                  <el-alert 
                    title="默认配置说明" 
                    type="info" 
                    :closable="false"
                    class="mb-2"
                  >
                    已自动填充 {{ newProviderTemp.vendor }} 的默认API地址<br>
                    填入API密钥之后点击右上角的放大镜，可以获得模型ID列表
                  </el-alert>
                </div>
              </el-form>
        
              <template #footer>
                <el-button @click="showAddDialog = false">取消</el-button>
                <el-button 
                  type="primary" 
                  @click="confirmAddProvider"
                  :disabled="!validProvider"
                >
                  确认添加
                </el-button>
              </template>
            </el-dialog>
          </div>
        </div>        
        

        <!-- 工具界面 -->
        <div v-show="activeMenu === 'tools'" class="page tools-container">
          <el-form :model="toolsSettings" class="settings-form">
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('time')">
                <span>
                  <el-icon><timer /></el-icon>
                  当前时间
                </span>
                <el-switch v-model="toolsSettings.time.enabled" @click.stop @change="autoSaveSettings"/>
              </div>
            </div>
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('inference')">
                <span>
                  <el-icon><reading-lamp /></el-icon>
                  伪推理
                </span>
                <el-switch v-model="toolsSettings.inference.enabled" @click.stop @change="autoSaveSettings"/>
              </div>
            </div>
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('language')">
                <span>
                  <el-icon><comment /></el-icon>
                  语言语气
                </span>
                <el-switch v-model="toolsSettings.language.enabled" @click.stop @change="autoSaveSettings"/>
              </div>
              <div class="tool-content" v-show="expandedSections.language">
                <el-form-item label="助手语言" class="form-item-align">
                  <el-select 
                    v-model="toolsSettings.language.language" 
                    @change="autoSaveSettings"
                    class="full-width-input"
                  >
                    <!--从languageOptions中动态加载-->
                    <el-option v-for="option in languageOptions" :key="option.value" :label="option.label" :value="option.value"></el-option>
                  </el-select>
                </el-form-item>
                <el-form-item label="助手语气" class="form-item-align">
                  <el-select 
                    v-model="toolsSettings.language.tone" 
                    @change="autoSaveSettings"
                    class="full-width-input"
                  >
                     <!--从toneOptions中动态加载-->
                    <el-option v-for="option in toneOptions" :key="option.value" :label="option.label" :value="option.value"></el-option>
                  </el-select>
                </el-form-item>
              </div>
            </div>
          </el-form>
        </div>

        <!-- 联网搜索界面 -->
        <div v-show="activeMenu === 'websearch'" class="page tools-container">
          <el-form :model="webSearchSettings" class="settings-form">
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('webSearchConfig')">
                <div class="header-left">
                  <span>
                    <el-icon><search /></el-icon>
                    联网搜索
                  </span>
                </div>
                <el-switch v-model="webSearchSettings.enabled" @click.stop @change="autoSaveSettings"/>
              </div>
              <div class="tool-content" v-show="expandedSections.webSearchConfig">
                <el-form-item label="搜索引擎" class="form-item-align">
                  <el-select 
                    v-model="webSearchSettings.engine" 
                    @change="autoSaveSettings"
                    class="full-width-input"
                  >
                    <el-option label="DuckDuckGo" value="duckduckgo" ></el-option>
                    <el-option label="SearXNG" value="searxng" ></el-option>
                    <el-option label="tavily" value="tavily" ></el-option>
                  </el-select>
                </el-form-item>
                <el-form-item label="联网时机" class="form-item-align">
                  <el-select 
                    v-model="webSearchSettings.when" 
                    @change="autoSaveSettings"
                    class="full-width-input"
                  >
                    <el-option label="思考前" value="before_thinking" ></el-option>
                    <el-option label="思考后" value="after_thinking" ></el-option>
                    <el-option label="两者都" value="both" ></el-option>
                  </el-select>
                </el-form-item>
              </div>
            </div>
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('duckduckgoConfig')">
                <div class="header-left">
                  <span>
                    <el-icon><search /></el-icon>
                    DuckDuckGo
                  </span>
                </div>
              </div>
              <div class="tool-content" v-show="expandedSections.duckduckgoConfig">
                <el-form-item label="结果数量" class="form-item-align">
                  <el-slider
                    v-model="webSearchSettings.duckduckgo_max_results"
                    :min="1"
                    :max="50"
                    :step="1"
                    @input="autoSaveSettings"
                  />
                </el-form-item>
              </div>
            </div>
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('searxngConfig')">
                <div class="header-left">
                  <span>
                    <el-icon><search /></el-icon>
                    SearXNG
                  </span>
                </div>
              </div>
              <div class="tool-content" v-show="expandedSections.searxngConfig">
                <el-form-item label="结果数量" class="form-item-align">
                  <el-slider
                    v-model="webSearchSettings.searxng_max_results"
                    :min="1"
                    :max="50"
                    :step="1"
                    @input="autoSaveSettings"
                  />
                </el-form-item>
                <el-form-item label="基础URL" class="form-item-align">
                  <el-input 
                    v-model="webSearchSettings.searxng_url" 
                    placeholder="SearXNG URL"
                    @input="autoSaveSettings"
                    class="full-width-input"
                  />
                </el-form-item>
              </div>
            </div>
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('tavilyConfig')">
                <div class="header-left">
                  <span>
                    <el-icon><search /></el-icon>
                    Tavily
                  </span>
                </div>
              </div>
              <div class="tool-content" v-show="expandedSections.tavilyConfig">
                <el-form-item label="结果数量" class="form-item-align">
                  <el-slider
                    v-model="webSearchSettings.tavily_max_results"
                    :min="1"
                    :max="50"
                    :step="1"
                    @input="autoSaveSettings"
                  />
                </el-form-item>
                <el-form-item label="API Key" class="form-item-align">
                  <el-input 
                    v-model="webSearchSettings.tavily_api_key" 
                    placeholder="tavily API 密钥"
                    show-password
                    @input="autoSaveSettings"
                    class="full-width-input"
                  />
                </el-form-item>
              </div>
            </div>
          </el-form>
        </div>
        <!-- API列表 -->
        <!-- 修改后的API列表界面 -->
        <div v-show="activeMenu === 'api'" class="page tools-container">
          <el-form class="settings-form">
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('superapi')">
                  <span>
                    <el-icon><key /></el-icon>
                    使用Super API
                  </span>
              </div>
              <div class="tool-content" v-show="expandedSections.superapi">
                <!-- 模型名称 -->
                <el-form-item label="模型名称" class="form-item-align">
                  <el-input 
                    :value="'super-model'" 
                    readonly 
                    class="full-width-input"
                  >
                    <template #append>
                      <el-button 
                        @click="copyModel"
                        :icon="'document-copy'"
                        class="copy-btn"
                      />
                    </template>
                  </el-input>
                </el-form-item>

                <!-- API端点 -->
                <el-form-item label="API 端点" class="form-item-align">
                  <el-input 
                    :value="'http://127.0.0.1:3456/v1'" 
                    readonly 
                    class="full-width-input"
                  >
                    <template #append>
                      <el-button 
                        @click="copyEndpoint"
                        :icon="'document-copy'"
                        class="copy-btn"
                      />
                    </template>
                  </el-input>
                </el-form-item>
                <!-- 在index.html的API配置区块内添加 -->
                <el-form-item label="示例语言" class="form-item-align">
                  <el-select 
                    v-model="selectedCodeLang" 
                    @change="autoSaveSettings"
                    class="full-width-input"
                  >
                    <el-option label="Python" value="python"></el-option>
                    <el-option label="JavaScript" value="javascript"></el-option>
                    <el-option label="cURL" value="curl"></el-option>
                  </el-select>
                </el-form-item>

                <!-- 修改index.html中的代码块结构 -->
                <div class="code-block">
                  <div class="code-header">
                    <span class="code-lang">{{ selectedCodeLang }}</span>
                    <button class="copy-button" @click.prevent="handleCopy">复制</button>
                  </div>
                  <pre><code class="hljs" :class="'language-' + selectedCodeLang">{{ codeExamples[selectedCodeLang] }}</code></pre>
                </div>
              </div>
            </div>
          </el-form>
        </div>


        <!-- 主模型界面 -->
        <!-- 修改后的主模型界面 -->
        <div v-show="activeMenu === 'settings'" class="page tools-container">
          <el-form :model="settings" class="settings-form">
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('settingsBase')">
                <div class="header-left">
                  <span>
                    <el-icon><trophy-base /></el-icon>
                    基础配置
                  </span>
                </div>
              </div>
              <div class="tool-content" v-show="expandedSections.settingsBase">
                <el-form-item label="供应商" class="form-item-align">
                  <el-select 
                    v-model="settings.selectedProvider" 
                    placeholder="选择供应商"
                    filterable
                    @change="selectMainProvider"
                    @visible-change="handleMainProviderVisibleChange"
                    class="full-width-input"
                  >
                    <el-option
                      v-for="provider in modelProviders"
                      :key="provider.id"
                      :label="provider.vendor"
                      :value="provider.id"
                    >
                      <div class="provider-option">
                        <span class="vendor-tag">{{ provider.vendor }}</span>
                        <span class="model-id">{{ provider.modelId }}</span>
                      </div>
                    </el-option>
                  </el-select>
                </el-form-item>
                <el-form-item label="模型名称" class="form-item-align">
                  <el-input 
                    v-model="settings.model" 
                    placeholder="模型名称"
                    @input="autoSaveSettings" 
                    class="full-width-input"
                  />
                </el-form-item>
                <el-form-item label="基础URL" class="form-item-align">
                  <el-input 
                    v-model="settings.base_url" 
                    placeholder="基础URL"
                    @input="autoSaveSettings"
                    class="full-width-input"
                  />
                </el-form-item>
                <el-form-item label="API密钥" class="form-item-align">
                  <el-input 
                    v-model="settings.api_key" 
                    placeholder="API密钥" 
                    show-password
                    @input="autoSaveSettings"
                    class="full-width-input"
                  />
                </el-form-item>
              </div>
            </div>

            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('settingsAdvanced')">
                <div class="header-left">
                  <span>
                    <el-icon><coffee-cup /></el-icon>
                    高级设置
                  </span>
                </div>
              </div>
              <div class="tool-content" v-show="expandedSections.settingsAdvanced">
                <el-form-item label="温度" class="form-item-align">
                  <el-slider
                    v-model="settings.temperature"
                    :min="0"
                    :max="1"
                    :step="0.1"
                    @input="autoSaveSettings"
                  />
                </el-form-item>
                <el-form-item label="输出长度" class="form-item-align">
                  <el-slider
                    v-model="settings.max_tokens"
                    :min="0"
                    :max="128000"
                    :step="1024"
                    @input="autoSaveSettings"
                  />
                </el-form-item>
                <el-form-item label="对话轮数" class="form-item-align">
                  <el-slider
                    v-model="settings.max_rounds"
                    :min="0"
                    :max="1000"
                    :step="2"
                    @input="autoSaveSettings"
                  />
                </el-form-item>
              </div>
            </div>
          </el-form>
        </div>
        <!-- 知识库界面 -->
        <div v-show="activeMenu === 'document'" class="page tools-container">
          <el-form :model="knowledgeSettings" class="settings-form">
            <!-- 可折叠表头 -->
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('knowledgeHeader')">
                <span>
                  <el-icon><notebook /></el-icon>
                  知识库配置
                </span>
                <el-switch v-model="knowledgeSettings.enabled" @click.stop @change="autoSaveSettings"/>
              </div>
              
              <!-- 配置内容 -->
              <div class="tool-content" v-show="expandedSections.knowledgeHeader">
                <el-form-item label="供应商" class="form-item-align">
                  <el-select 
                    v-model="knowledgeSettings.selectedProvider" 
                    placeholder="选择供应商"
                    filterable
                    @change="selectKnowledgeProvider"
                    @visible-change="handleKnowledgeProviderVisibleChange"
                    class="full-width-input"
                  >
                    <el-option
                      v-for="provider in modelProviders"
                      :key="provider.id"
                      :label="provider.vendor"
                      :value="provider.id"
                    >
                      <div class="provider-option">
                        <span class="vendor-tag">{{ provider.vendor }}</span>
                        <span class="model-id">{{ provider.modelId }}</span>
                      </div>
                    </el-option>
                  </el-select>
                </el-form-item>
                <!-- 输入框组 -->
                <el-form-item label="检索模型" class="form-item-align">
                  <el-input 
                    v-model="knowledgeSettings.model" 
                    placeholder="模型名称"
                    @input="autoSaveSettings"
                    class="full-width-input"
                  />
                </el-form-item>
                
                <el-form-item label="基础URL" class="form-item-align">
                  <el-input 
                    v-model="knowledgeSettings.base_url" 
                    placeholder="API服务地址"
                    @input="autoSaveSettings"
                    class="full-width-input"
                  />
                </el-form-item>
                
                <el-form-item label="API密钥" class="form-item-align">
                  <el-input 
                    v-model="knowledgeSettings.api_key" 
                    placeholder="请输入API密钥"
                    show-password
                    @input="autoSaveSettings"
                    class="full-width-input"
                  />
                </el-form-item>

                <!-- 滑动条组 -->
                <el-form-item label="分段大小" class="form-item-align">
                  <el-slider
                    v-model="knowledgeSettings.chunk_size"
                    :min="128"
                    :max="1024"
                    :step="128"
                    :format-tooltip="val => `${val} tokens`"
                    @input="autoSaveSettings"
                  />
                </el-form-item>

                <el-form-item label="重叠大小" class="form-item-align">
                  <el-slider
                    v-model="knowledgeSettings.overlap_size"
                    :min="0"
                    :max="256"
                    :step="32"
                    :format-tooltip="val => `${val} tokens`"
                    @input="autoSaveSettings"
                  />
                </el-form-item>

                <el-form-item label="匹配度" class="form-item-align">
                  <el-slider
                    v-model="knowledgeSettings.score_threshold"
                    :min="0"
                    :max="1"
                    :step="0.1"
                    :format-tooltip="val => val.toFixed(1)"
                    @input="autoSaveSettings"
                  />
                </el-form-item>

                <!-- 文件上传区域 -->
                <div class="upload-container">
                  <el-upload
                    class="drop-zone"
                    drag
                    multiple
                    :auto-upload="false"
                    :on-change="handleKnowledgeFile"
                    :show-file-list="false"
                  >
                    <el-icon :size="50"><upload /></el-icon>
                    <p>拖放文件或点击上传</p>
                  </el-upload>
                  
                  <!-- 文件列表 -->
                  <div class="file-list">
                    <div v-for="(file, index) in knowledgeFiles" :key="index" class="file-item">
                      <a :href="file.path" target="_blank" class="file-link">
                        {{ file.name }}
                      </a>
                      <el-button 
                        @click="removeKnowledgeFile(index)"
                        :icon="'delete'"
                        circle
                        size="small"
                        class="delete-btn"
                      />
                    </div>
                  </div>
                </div>

                <!-- 生成按钮 -->
                <el-button 
                  type="primary" 
                  @click="generateKnowledgeBase"
                  class="generate-btn"
                >
                  生成知识库
                </el-button>
              </div>
            </div>
          </el-form>
        </div>

        <!-- 推理模型界面 -->
        <div v-show="activeMenu === 'reasoner'" class="page tools-container">
          <el-form :model="settings" class="settings-form">
            <div class="tool-item">
              <div class="tool-header" @click="toggleSection('reasonerConfig')">
                <div class="header-left">
                  <span>
                    <el-icon><reading-lamp /></el-icon>
                    推理配置
                  </span>
                </div>
                <el-switch v-model="reasonerSettings.enabled" @click.stop @change="autoSaveSettings"/>
              </div>
              <div class="tool-content" v-show="expandedSections.reasonerConfig">   
                <el-form-item label="供应商" class="form-item-align">
                  <el-select 
                    v-model="reasonerSettings.selectedProvider" 
                    placeholder="选择供应商"
                    filterable
                    @change="selectReasonerProvider"
                    @visible-change="handleReasonerProviderVisibleChange"
                    class="full-width-input"
                  >
                    <el-option
                      v-for="provider in modelProviders"
                      :key="provider.id"
                      :label="provider.vendor"
                      :value="provider.id"
                    >
                      <div class="provider-option">
                        <span class="vendor-tag">{{ provider.vendor }}</span>
                        <span class="model-id">{{ provider.modelId }}</span>
                      </div>
                    </el-option>
                  </el-select>
                </el-form-item>     
                <el-form-item label="模型名称" class="form-item-align">
                  <el-input 
                    v-model="reasonerSettings.model" 
                    placeholder="模型名称"
                    @input="autoSaveSettings" 
                    class="full-width-input"
                  />
                </el-form-item>
                <el-form-item label="基础URL" class="form-item-align">
                  <el-input 
                    v-model="reasonerSettings.base_url" 
                    placeholder="基础URL"
                    @input="autoSaveSettings"
                    class="full-width-input"
                  />
                </el-form-item>
                <el-form-item label="API密钥" class="form-item-align">
                  <el-input 
                    v-model="reasonerSettings.api_key" 
                    placeholder="API密钥" 
                    show-password
                    @input="autoSaveSettings"
                    class="full-width-input"
                  />
                </el-form-item>
              </div>
            </div>
          </el-form>
        </div>
      </el-main>
    </el-container>
  </div>

  <!-- 引入Vue和Element Plus -->
  <script src="node_modules/vue/dist/vue.global.js"></script>
  <script src="node_modules/element-plus/dist/index.full.js"></script>
  <script src="node_modules/@element-plus/icons-vue/dist/index.iife.min.js"></script>
  <script src="js/renderer.js"></script>
</body>
</html>
